@page "/restaurants/{RestaurantId}"
@using CasperDelivery.Interfaces
@using CasperDelivery.Interfaces.Specifications
@inject ICartService cartService

@if(Restaurant != null)
{

    <div class="bg-image d-flex justify-content-center align-items-center"
         style="
         background-image: url('images/Restaurantsbackground/@Restaurant.BackgroundUrl');
         height: 40vh;
      ">
        <h1 class="text-white blur-background">@Restaurant.Name</h1>
    </div>

    <div class="container mt-5">
        <div class="row product-lists">
            @foreach (var item in Restaurant.Products)
            {
                <div class="col-lg-4 col-md-6 text-center">
                    <div class="single-product-item">
                        <div class="product-image">
                            <img src="images/Products/@item.PictureUrl" alt="" style="width: 200px; height: 200px; object-fit: cover;" />
                        </div>
                        <h3>@item.Name</h3>
                        <p class="product-price">@String.Format("{0:0.00}", item.Price) $</p>
                        <AuthorizeView>
                            <Authorized>
                                <button onclick="@(async () => await cartService.AddItemToCart(item.Id));showLiveToast()" class="cart-btn livetoastbtn"><i class="fas fa-shopping-cart"></i> Add to Cart</button>
                            </Authorized>
                            <NotAuthorized>
                                <p>You need to enter your account to add item to cart</p>
                            </NotAuthorized>
                        </AuthorizeView>
                        
                    </div>
                </div>
            }
        </div>
    </div>
}

<div class="toast-container position-fixed bottom-0 end-0 p-3">
    <div id="liveToast" class="toast" role="alert" aria-live="assertive" aria-atomic="true">
        <div class="toast-header">
            <img src="images/Logo/casper-delivery-logo.png" class="rounded me-2" alt="...">
            <strong class="me-auto">Casper Delivery</strong>
            <small>now</small>
            <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
        </div>
        <div class="toast-body">
            Your item has been added to cart!
        </div>
    </div>
</div>
<script>
    function showLiveToast() {
        const toastLiveExample = document.getElementById('liveToast');
        const toastBootstrap = new bootstrap.Toast(toastLiveExample);
        toastBootstrap.show();
    }
</script>









@code {
    [Parameter]
    public string RestaurantId { get; set; }

    Restaurants Restaurant;
    protected override async Task OnParametersSetAsync()
    {
        int Id = int.Parse(RestaurantId);
        Restaurant = await cartService.GetRestaurantInfo(Id);
    }
}